---
// Hero component with SVG diagram
---

<div class="diagram-container">
      <header class="section-head">
    <h2 class="section-title">How Softprobe AI Works</h2>
    <p class="section-subtitle">
      Learns from everything you have. Code, docs, tools and most importantly - Runtime Truth - with proprietary Softprobe Context Engineâ„¢. 
	    </p>
	  </header>
      
    <svg class="connections-layer" id="connections">
        </svg>

    <div class="roles-row">
        <div class="role-card" id="role-1">Dev</div>
        <div class="role-card" id="role-2">SRE Engineer</div>
        <div class="role-card" id="role-3">QA Engineer</div>
        <div class="role-card" id="role-4">IT Ops</div>
    </div>

    <div class="core-container" id="core-box">
        <div class="core-chat-history" aria-label="Softprobe incident workflow chat history">
            <div class="core-trace-header">
                <span class="core-trace-live-dot" aria-hidden="true"></span>
                <span>Investigating ...</span>
            </div>
            <div class="core-chat-track">
                <div class="core-trace-item kind-thinking">
                    <div class="core-trace-meta">
                        <span class="core-trace-kind">Thinking</span>
                        <span class="core-trace-time">T+04s</span>
                    </div>
                    <p>Correlating checkout 5xx spike with deploy <code>checkout-api@2026.02.11.4</code>.</p>
                    <span class="core-trace-dots" aria-hidden="true"></span>
                </div>
                <div class="core-trace-item kind-tool">
                    <div class="core-trace-meta">
                        <span class="core-trace-kind">Tool Call</span>
                        <span class="core-trace-time">T+08s</span>
                    </div>
                    <p>Fetching evidence from Grafana, Sentry <code>CHK-991</code>, and Argo rollout events.</p>
                    <pre class="core-trace-command">grafana.query(service="checkout", metric="http_5xx_rate", window="15m")</pre>
                </div>
                <div class="core-trace-item kind-observe">
                    <div class="core-trace-meta">
                        <span class="core-trace-kind">Observation</span>
                        <span class="core-trace-time">T+13s</span>
                    </div>
                    <p>p95 latency jumped <strong>480ms -> 2.1s</strong> only on revision tied to commit <code>a18f2c9</code>.</p>
                </div>
                <div class="core-trace-item kind-tool">
                    <div class="core-trace-meta">
                        <span class="core-trace-kind">Tool Call</span>
                        <span class="core-trace-time">T+18s</span>
                    </div>
                    <pre class="core-trace-command">kubectl logs deploy/checkout-api -n prod --since=15m | rg "timeout|pool exhausted"</pre>
                </div>
                <div class="core-trace-item kind-action">
                    <div class="core-trace-meta">
                        <span class="core-trace-kind">Action</span>
                        <span class="core-trace-time">T+24s</span>
                    </div>
                    <p>Executing rollback to <code>checkout-api@2026.02.11.3</code> and opening <code>INC-214</code>.</p>
                </div>
                <div class="core-trace-item kind-verify">
                    <div class="core-trace-meta">
                        <span class="core-trace-kind">Verify</span>
                        <span class="core-trace-time">T+31s</span>
                    </div>
                    <p>5xx recovered from 8.2% to 0.3%. Posted incident summary to <code>#prod-incidents</code>.</p>
                </div>
            </div>
        </div>

        <div class="logo-center">
            <div class="logo-icon">
                <img class="robot-logo" src="/logos/4.svg" alt="Softprobe" width="72" height="72" decoding="async" />
            </div>
        </div>

        <div class="core-modules">
            <div class="module-box">Softprobe Context Engine</div>
        </div>
    </div>

    <div class="agents-row">
        <div class="agent-node" id="agent-1">
            <svg class="fa-robot" viewBox="0 0 24 24"><path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z" /></svg>
        </div>
        <div class="agent-node" id="agent-2">
            <svg class="fa-robot" viewBox="0 0 24 24"><path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z" /></svg>
        </div>
        <div class="agent-node" id="agent-3">
            <svg class="fa-robot" viewBox="0 0 24 24"><path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z" /></svg>
        </div>
        <div class="agent-node" id="agent-4">
            <svg class="fa-robot" viewBox="0 0 24 24"><path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z" /></svg>
        </div>
        <div class="agent-node" id="agent-5">
            <svg class="fa-robot" viewBox="0 0 24 24"><path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z" /></svg>
        </div>
    </div>

    <div class="tools-row">
        <div class="tool-group group-observability" id="group-1">
            <div class="group-title">Observability</div>
            <div class="icons-wrapper">
                <img class="tool-icon" src="https://cdn.simpleicons.org/prometheus/E6522C" alt="Prometheus" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/grafana/F46800" alt="Grafana" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/datadog/632CA6" alt="Datadog" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/sentry/362D59" alt="Sentry" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/newrelic/1CE783" alt="New Relic" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/opentelemetry/000000" alt="opentelemetry" />
            </div>
        </div>

        <div class="tool-group group-knowledge" id="group-2">
            <div class="group-title">Knowledge</div>
            <div class="icons-wrapper">
                <img class="tool-icon" src="/slack.png" alt="Slack" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/jira/0052CC" alt="Jira" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/notion/000000" alt="Notion" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/confluence/172B4D" alt="Confluence" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/linear/5E6AD2" alt="Linear" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/googledrive/0F9D58" alt="Drive" />
            </div>
        </div>

        <div class="tool-group group-code" id="group-3">
            <div class="group-title">Code</div>
            <div class="icons-wrapper">
                <img class="tool-icon" src="https://cdn.simpleicons.org/gitlab/FC6D26" alt="GitLab" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/github/181717" alt="GitHub" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/bitbucket/0052CC" alt="Bitbucket" />
            </div>
        </div>

        <div class="tool-group group-testing" id="group-4">
            <div class="group-title">Testing</div>
            <div class="icons-wrapper">
                <img class="tool-icon" src="https://cdn.simpleicons.org/cypress/17202C" alt="Cypress" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/saucelabs/3DDC91" alt="Saucelabs" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/curl/073551" alt="Curl" />
            </div>
        </div>

        <div class="tool-group group-devops" id="group-5">
            <div class="group-title">DevOps & CI/CD</div>
            <div class="icons-wrapper">
                <img class="tool-icon" src="/aws.svg" alt="AWS" />
                <img class="tool-icon" src="/gcp.svg" alt="GCP" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/kubernetes/326CE5" alt="K8s" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/helm/0F1689" alt="Helm" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/argo/EF7B4D" alt="Argo" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/githubactions/2088FF" alt="Actions" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/travisci/3EAAAF" alt="TravisCI" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/jenkins/D24939" alt="Jenkins" />
                <img class="tool-icon" src="https://cdn.simpleicons.org/circleci/343434" alt="CircleCI" />
            </div>
        </div>
    </div>
</div>

<script>
    // Logic to draw lines and animate particles
    function initHeroDiagram() {
        const svg = document.getElementById('connections');
        const coreBox = document.getElementById('core-box');

        if (!svg || !coreBox) return;

        // Groups map to Agents (index based)
        const groups = [
            document.getElementById('group-1'),
            document.getElementById('group-2'),
            document.getElementById('group-3'),
            document.getElementById('group-4'),
            document.getElementById('group-5')
        ];
        
        const agents = [
            document.getElementById('agent-1'),
            document.getElementById('agent-2'),
            document.getElementById('agent-3'),
            document.getElementById('agent-4'),
            document.getElementById('agent-5')
        ];

        function getCenter(element) {
            const rect = element.getBoundingClientRect();
            const containerRect = document.querySelector('.diagram-container').getBoundingClientRect();
            return {
                x: rect.left + rect.width / 2 - containerRect.left,
                y: rect.top + rect.height / 2 - containerRect.top,
                top: rect.top - containerRect.top,
                bottom: rect.bottom - containerRect.top
            };
        }

        function createLine(x1, y1, x2, y2) {
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            // Create a slight curve (bezier)
            const d = `M ${x1} ${y1} C ${x1} ${(y1+y2)/2}, ${x2} ${(y1+y2)/2}, ${x2} ${y2}`;
            path.setAttribute('d', d);
            path.setAttribute('class', 'connection-line');
            
            // Add particle for animation
            const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            circle.setAttribute('r', '4');
            circle.setAttribute('class', 'flow-particle');
            
            // Animate along path
            const animateMotion = document.createElementNS('http://www.w3.org/2000/svg', 'animateMotion');
            animateMotion.setAttribute('dur', (Math.random() * 1 + 2) + 's'); // Random speed
            animateMotion.setAttribute('repeatCount', 'indefinite');
            animateMotion.setAttribute('path', d);
            
            circle.appendChild(animateMotion);
            
            return { path, circle };
        }

        function draw() {
            // Clear existing
            svg.innerHTML = '';
            
            const coreCenter = getCenter(coreBox);

            // Draw Lines: Agent -> Core
            agents.forEach((agent) => {
                if (agent) {
                    const agentCenter = getCenter(agent);
                    // Draw from top of agent to bottom of core
                    const { path, circle } = createLine(agentCenter.x, agentCenter.top, coreCenter.x, coreCenter.bottom);
                    svg.appendChild(path);
                    svg.appendChild(circle);
                }
            });

            // Draw Lines: Tool Group -> Agent
            groups.forEach((group, index) => {
                if(group && agents[index]) {
                    const groupCenter = getCenter(group);
                    const agentCenter = getCenter(agents[index]);
                    const { path, circle } = createLine(groupCenter.x, groupCenter.top, agentCenter.x, agentCenter.bottom);
                    svg.appendChild(path);
                    // Reverse animation for variety (Tools -> Agent)
                    const anim = circle.querySelector('animateMotion');
                    anim.setAttribute('keyPoints', "1;0");
                    anim.setAttribute('keyTimes', "0;1");
                    svg.appendChild(circle);
                }
            });
        }

        // Initial draw
        if (document.readyState === 'loading') {
            window.addEventListener('load', draw);
        } else {
            draw();
        }
        // Redraw on resize
        window.addEventListener('resize', draw);
    }

    function initTraceStepper() {
        const history = document.querySelector('.core-chat-history');
        const track = history?.querySelector('.core-chat-track');
        if (!history || !track) return;
        if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

        const items = Array.from(track.querySelectorAll('.core-trace-item'));
        if (!items.length) return;

        const holdMs = 1500;
        const loopPauseMs = 1200;
        let currentIndex = -1;

        items.forEach((item) => item.classList.remove('is-visible'));

        function showNext(delay = holdMs) {
            window.setTimeout(() => {
                const isLastStep = currentIndex >= items.length - 1;

                if (isLastStep) {
                    items.forEach((item) => item.classList.remove('is-visible'));
                    currentIndex = 0;
                    items[currentIndex].classList.add('is-visible');
                    showNext(loopPauseMs);
                    return;
                }

                currentIndex += 1;
                items[currentIndex].classList.add('is-visible');
                const nextDelay = currentIndex === items.length - 1 ? loopPauseMs : holdMs;
                showNext(nextDelay);
            }, delay);
        }

        showNext(400);
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            initHeroDiagram();
            initTraceStepper();
        });
    } else {
        initHeroDiagram();
        initTraceStepper();
    }
</script>
