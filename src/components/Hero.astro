---
// Hero component with SVG diagram
---

<div class="hero-layout-wrapper">
    <div class="hero-steps-column">
        <header class="section-head">
            <h2 class="section-title">How Softprobe AI SRE Works</h2>
        </header>

        <div class="step-cards-container">
            <article class="step-card">
                <div class="step-label">STEP 01</div>
                <h3 class="step-title">Capture & Replay</h3>
                <p class="step-text">Softprobe silently captures real production traffic and user sessions. Before your next release, our AI replays them in your test environment to validate everything works.</p>
            </article>

            <article class="step-card">
                <div class="step-label">STEP 02</div>
                <h3 class="step-title">Softprobe Builds the Session Graph</h3>
                <p class="step-text">Every request, response, and execution path is stored as a structured session graph â€” 100% of data, zero sampling. This gives AI a complete map of your system behavior.</p>
            </article>

            <article class="step-card">
                <div class="step-label">STEP 03</div>
                <h3 class="step-title">AI SRE handles testing, production monitoring and debugging</h3>
                <p class="step-text">Structured session graph architecture enables agentic review of execution path to find exact error causes; fully deterministic (no probabilistic guessing)</p>
            </article>
        </div>
    </div>

    <div class="hero-diagram-column">
        <div class="diagram-container">
            <svg class="connections-layer" id="connections"></svg>

            <div class="roles-row">
                <div class="role-card" id="role-1">Dev</div>
                <div class="role-card" id="role-2">SRE</div>
                <div class="role-card" id="role-3">QA</div>
                <div class="role-card" id="role-4">IT</div>
            </div>
            
            <div class="core-container" id="core-box">
                <div class="core-chat-history" aria-label="Softprobe incident workflow chat history">
                    <div class="core-trace-header">
                        <span class="core-trace-live-dot" aria-hidden="true"></span>
                        <span>Investigating ...</span>
                    </div>
                    <div class="core-chat-track">
                        <div class="core-trace-item kind-thinking">
                            <div class="core-trace-meta">
                                <span class="core-trace-kind">Thinking</span>
                                <span class="core-trace-time">T+04s</span>
                            </div>
                            <p>Correlating checkout 5xx spike with deploy.</p>
                        </div>
                        <div class="core-trace-item kind-tool">
                            <div class="core-trace-meta">
                                <span class="core-trace-kind">Tool Call</span>
                                <span class="core-trace-time">T+08s</span>
                            </div>
                            <pre class="core-trace-command">grafana.query(service="checkout")</pre>
                        </div>
                        <div class="core-trace-item kind-action">
                            <div class="core-trace-meta">
                                <span class="core-trace-kind">Action</span>
                                <span class="core-trace-time">T+24s</span>
                            </div>
                            <p>Executing rollback and opening INC-214.</p>
                        </div>
                    </div>
                </div>

                <div class="logo-center">
                    <div class="logo-icon">
                        <img class="robot-logo" src="/logos/4.svg" alt="Softprobe" width="56" height="56" decoding="async" />
                    </div>
                </div>

                <div class="core-modules">
                    <div class="module-box">Context Engine</div>
                </div>
            </div>

            <div class="agents-row">
                <div class="agent-node" id="agent-1"></div>
                <div class="agent-node" id="agent-2"></div>
                <div class="agent-node" id="agent-3"></div>
                <div class="agent-node" id="agent-4"></div>
            </div>

            <div class="tools-row">
                <div class="tool-group" id="group-1">
                    <div class="icons-wrapper">
                        <img class="tool-icon" src="https://cdn.simpleicons.org/prometheus/E6522C" alt="Prometheus" />
                        <img class="tool-icon" src="https://cdn.simpleicons.org/datadog/632CA6" alt="Datadog" />
                    </div>
                </div>
                <div class="tool-group" id="group-2">
                    <div class="icons-wrapper">
                        <img class="tool-icon" src="/slack.png" alt="Slack" />
                    </div>
                </div>
                <div class="tool-group" id="group-3">
                    <div class="icons-wrapper">
                        <img class="tool-icon" src="https://cdn.simpleicons.org/github/181717" alt="GitHub" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<style>
    .hero-layout-wrapper {
        display: grid;
        grid-template-columns: 1.2fr 1fr;
        gap: 60px;
        align-items: center;
        width: min(var(--site-page-max-width), 100%);
        margin: 60px auto;
        padding: 0 24px;
    }

    .hero-steps-column {
        display: flex;
        flex-direction: column;
        gap: 32px;
    }

    .hero-steps-column .section-head {
        text-align: left;
        margin: 0;
        padding: 0;
    }

    .hero-steps-column .section-title {
        font-size: clamp(2rem, 4vw, 2.75rem);
        line-height: 1.1;
        margin-bottom: 0;
    }

    .step-cards-container {
        display: grid;
        gap: 20px;
    }

    .step-card {
        background: #ffffff;
        border: 1px solid #e2e8f0;
        border-radius: 20px;
        padding: 24px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .step-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.02);
    }

    .step-label {
        font-size: 0.75rem;
        font-weight: 800;
        color: #7c3aed;
        letter-spacing: 0.1em;
        margin-bottom: 8px;
    }

    .step-title {
        font-size: 1.25rem;
        font-weight: 800;
        color: #0f172a;
        margin: 0 0 10px 0;
        line-height: 1.3;
    }

    .step-text {
        font-size: 0.95rem;
        color: #475569;
        line-height: 1.6;
        margin: 0;
    }

    /* Diagram Styling - Minimized */
    .hero-diagram-column {
        position: relative;
        background: #f8fafc;
        border-radius: 32px;
        border: 1px solid #e2e8f0;
        padding: 40px 20px;
        overflow: hidden;
    }

    .diagram-container {
        position: relative;
        width: 100%;
        height: 500px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-between;
    }

    .connections-layer {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }

    .connection-line {
        fill: none;
        stroke: #cbd5e1;
        stroke-width: 1.5;
        opacity: 0.4;
    }

    .flow-particle {
        fill: #7c3aed;
        filter: blur(1px);
    }

    /* Rows */
    .roles-row, .agents-row, .tools-row {
        display: flex;
        justify-content: center;
        gap: 12px;
        width: 100%;
        position: relative;
        z-index: 2;
    }

    .role-card {
        padding: 6px 14px;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 999px;
        font-size: 0.7rem;
        font-weight: 800;
        color: #64748b;
        box-shadow: 0 4px 6px rgba(0,0,0,0.02);
    }

    .agent-node {
        width: 40px;
        height: 40px;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 6px rgba(0,0,0,0.02);
    }

    .agent-node::before {
        content: '';
        width: 18px;
        height: 18px;
        background: #7c3aed;
        mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'%3E%3Cpath fill-rule='evenodd' d='M12 6.75a5.25 5.25 0 0 1 6.775-5.025.75.75 0 0 1 .313 1.248l-3.32 3.319c.063.475.276.934.641 1.299.365.365.824.578 1.3.64l3.318-3.319a.75.75 0 0 1 1.248.313 5.25 5.25 0 0 1-5.472 6.756c-1.018-.086-1.87.1-2.309.634L7.344 21.3A3.298 3.298 0 1 1 2.7 16.657l8.684-7.151c.533-.44.72-1.291.634-2.309A5.342 5.342 0 0 1 12 6.75Zm4.117 19.125a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75h-.008a.75.75 0 0 1-.75-.75v-.008Z' clip-rule='evenodd'/%3E%3C/svg%3E") no-repeat center;
        mask-size: contain;
    }

    .core-container {
        position: relative;
        width: 220px;
        height: 220px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .logo-center {
        position: relative;
        z-index: 10;
        background: white;
        padding: 12px;
        border-radius: 24px;
        border: 1px solid #e2e8f0;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05);
    }

    .robot-logo {
        display: block;
    }

    .core-modules {
        position: absolute;
        bottom: -20px;
        z-index: 11;
    }

    .module-box {
        background: #7c3aed;
        color: white;
        font-size: 0.65rem;
        font-weight: 800;
        padding: 4px 12px;
        border-radius: 999px;
        white-space: nowrap;
    }

    /* Chat History - Scaled Down */
    .core-chat-history {
        position: absolute;
        top: -40px;
        right: -60px;
        width: 180px;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 10px;
        font-size: 0.6rem;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
        z-index: 5;
    }

    .core-trace-header {
        display: flex;
        align-items: center;
        gap: 6px;
        margin-bottom: 6px;
        color: #64748b;
        font-weight: 700;
    }

    .core-trace-live-dot {
        width: 6px;
        height: 6px;
        background: #22c55e;
        border-radius: 999px;
        animation: pulse 2s infinite;
    }

    .core-trace-item {
        display: none;
        margin-bottom: 6px;
    }

    .core-trace-item.is-visible {
        display: block;
        animation: fadeIn 0.3s ease;
    }

    .core-trace-meta {
        font-size: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-weight: 800;
        margin-bottom: 2px;
    }

    .kind-thinking .core-trace-meta { color: #8b5cf6; }
    .kind-tool .core-trace-meta { color: #0ea5e9; }
    .kind-action .core-trace-meta { color: #f59e0b; }

    .core-trace-command {
        background: #f1f5f9;
        padding: 4px;
        border-radius: 4px;
        font-family: monospace;
        display: block;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    .tool-group {
        padding: 8px;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
    }

    .icons-wrapper {
        display: flex;
        gap: 6px;
    }

    .tool-icon {
        width: 16px;
        height: 16px;
        border-radius: 4px;
    }

    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.4; }
        100% { opacity: 1; }
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(4px); }
        to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 1024px) {
        .hero-layout-wrapper {
            grid-template-columns: 1fr;
            gap: 40px;
        }

        .hero-diagram-column {
            display: none; /* Hide on smaller screens to prioritize cards */
        }
    }
</style>
<script>
    // Logic to draw lines and animate particles
    function initHeroDiagram() {
        const svg = document.getElementById('connections');
        const coreBox = document.getElementById('core-box');

        if (!svg || !coreBox) return;

        // Groups map to Agents (index based)
        const groups = [
            document.getElementById('group-1'),
            document.getElementById('group-2'),
            document.getElementById('group-3'),
            document.getElementById('group-4'),
            document.getElementById('group-5')
        ];
        
        const agents = [
            document.getElementById('agent-1'),
            document.getElementById('agent-2'),
            document.getElementById('agent-3'),
            document.getElementById('agent-4'),
            document.getElementById('agent-5')
        ];

        function getCenter(element) {
            const rect = element.getBoundingClientRect();
            const containerRect = document.querySelector('.diagram-container').getBoundingClientRect();
            return {
                x: rect.left + rect.width / 2 - containerRect.left,
                y: rect.top + rect.height / 2 - containerRect.top,
                top: rect.top - containerRect.top,
                bottom: rect.bottom - containerRect.top
            };
        }

        function createLine(x1, y1, x2, y2) {
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            // Create a slight curve (bezier)
            const d = `M ${x1} ${y1} C ${x1} ${(y1+y2)/2}, ${x2} ${(y1+y2)/2}, ${x2} ${y2}`;
            path.setAttribute('d', d);
            path.setAttribute('class', 'connection-line');
            
            // Add particle for animation
            const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            circle.setAttribute('r', '4');
            circle.setAttribute('class', 'flow-particle');
            
            // Animate along path
            const animateMotion = document.createElementNS('http://www.w3.org/2000/svg', 'animateMotion');
            animateMotion.setAttribute('dur', (Math.random() * 1 + 2) + 's'); // Random speed
            animateMotion.setAttribute('repeatCount', 'indefinite');
            animateMotion.setAttribute('path', d);
            
            circle.appendChild(animateMotion);
            
            return { path, circle };
        }

        function draw() {
            // Clear existing
            svg.innerHTML = '';
            
            const coreCenter = getCenter(coreBox);

            // Draw Lines: Agent -> Core
            agents.forEach((agent) => {
                if (agent) {
                    const agentCenter = getCenter(agent);
                    // Draw from top of agent to bottom of core
                    const { path, circle } = createLine(agentCenter.x, agentCenter.top, coreCenter.x, coreCenter.bottom);
                    svg.appendChild(path);
                    svg.appendChild(circle);
                }
            });

            // Draw Lines: Tool Group -> Agent
            groups.forEach((group, index) => {
                if(group && agents[index]) {
                    const groupCenter = getCenter(group);
                    const agentCenter = getCenter(agents[index]);
                    const { path, circle } = createLine(groupCenter.x, groupCenter.top, agentCenter.x, agentCenter.bottom);
                    svg.appendChild(path);
                    // Reverse animation for variety (Tools -> Agent)
                    const anim = circle.querySelector('animateMotion');
                    anim.setAttribute('keyPoints', "1;0");
                    anim.setAttribute('keyTimes', "0;1");
                    svg.appendChild(circle);
                }
            });
        }

        // Initial draw
        if (document.readyState === 'loading') {
            window.addEventListener('load', draw);
        } else {
            draw();
        }
        // Redraw on resize
        window.addEventListener('resize', draw);
    }

    function initTraceStepper() {
        const history = document.querySelector('.core-chat-history');
        const track = history?.querySelector('.core-chat-track');
        if (!history || !track) return;
        if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

        const items = Array.from(track.querySelectorAll('.core-trace-item'));
        if (!items.length) return;

        const holdMs = 1500;
        const loopPauseMs = 1200;
        let currentIndex = -1;

        items.forEach((item) => item.classList.remove('is-visible'));

        function showNext(delay = holdMs) {
            window.setTimeout(() => {
                const isLastStep = currentIndex >= items.length - 1;

                if (isLastStep) {
                    items.forEach((item) => item.classList.remove('is-visible'));
                    currentIndex = 0;
                    items[currentIndex].classList.add('is-visible');
                    showNext(loopPauseMs);
                    return;
                }

                currentIndex += 1;
                items[currentIndex].classList.add('is-visible');
                const nextDelay = currentIndex === items.length - 1 ? loopPauseMs : holdMs;
                showNext(nextDelay);
            }, delay);
        }

        showNext(400);
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            initHeroDiagram();
            initTraceStepper();
        });
    } else {
        initHeroDiagram();
        initTraceStepper();
    }
</script>
